# 知识库-文档分片接口


### 接口1：上传文件

#### 请求说明
- **HTTP方法**: POST
- **URL**: `https://faeb-175-6-30-17.ngrok-free.app/upload_documents`

#### 请求示例
```json
{
    "file_path": "http://39.105.167.2:9529/template.pdf",
    "content": ""
}
```

#### 请求字段说明
| 字段      | 类型   | 必需 | 说明                                                                 |
|-----------|--------|------|---------------------------------------------------------------------|
| file_path | string | ✓    | 文件URL路径，支持http/https协议                                     |
| content   | string |      | 直接上传的文本内容，与file_path二选一，当两者都提供时优先使用file_path |

#### 响应字段说明
| 字段               | 类型   | 说明                               |
|--------------------|--------|-----------------------------------|
| dataset_id         | string | 数据集 ID                         |
| document_id        | string | 完整文件ID                        |
| document_name      | string | 完整文件名                        |
| part_document_id   | string | 部分文件ID（用于快速展示）        |
| part_document_name | string | 部分文件名                        |
| sign               | bool   | 操作状态标识                      |

#### 响应示例
```json
{
    "dataset_id": "f6c5dc32298211f08b470242ac130006",
    "document_id": "f86a8ad8298211f0985d0242ac130006",
    "document_name": "template.pdf",
    "part_document_id": "fb783ab8298211f0afbf0242ac130006",
    "part_document_name": "part_template.pdf",
    "sign": true
}
```

---

### 接口2：文档解析

#### 功能描述
根据指定的解析方法返回文档切片

#### 请求说明
- **HTTP方法**: POST
- **URL**: `https://faeb-175-6-30-17.ngrok-free.app/analyzing_documents`

#### 请求参数
| 字段          | 类型   | 必需 | 说明                                                                 |
|---------------|--------|------|---------------------------------------------------------------------|
| dataset_id    | string | ✓    | 数据集 ID                                                          |
| document_id   | string | ✓    | 文件ID                                                             |
| document_name | string | ✓    | 文件名                                                             |
| chunk_method  | string | ✓    | 解析方法: naive, manual, qa, table, paper, book, laws, presentation, picture, email |
| parser_flag   | int    | ✓    | 是否需要设置parser_config (0: 否, 1: 是)                           |
| parser_config | dict   |      | 解析器配置 (根据chunk_method不同而不同)                            |

#### 解析方法说明
- **naive**: 基础解析
- **manual**: 手动解析
- **qa**: 问答模式
- **table**: 表格处理
- **paper**: 论文格式
- **book**: 书籍格式
- **laws**: 法律文档
- **presentation**: 演示文档
- **picture**: 图片处理
- **email**: 邮件处理

#### 请求示例1
```json
{
    "dataset_id": "f6c5dc32298211f08b470242ac130006",
    "document_id": "fb783ab8298211f0afbf0242ac130006",
    "document_name": "part-template.pdf",
    "chunk_method": "laws",
    "parser_flag": 0,
    "parser_config": {}
}
```

#### 响应示例1
```json
{
    "chunks": [
        "中华人民共和国网络安全法\n（2016 年11 月7日第十二届全国人民代表大会常务委员会第二十四次会议通过）目录",
        "第三章网络运行安全\n第一节一般规定",
        "第一章总则\n第一条为了保障网络安全...",
        // ... 其他分片内容 ...
    ],
    "sign": true
}
```

#### 请求示例2
```json
{
    "dataset_id": "f6c5dc32298211f08b470242ac130006",
    "document_id": "fb783ab8298211f0afbf0242ac130006",
    "document_name": "part-template.pdf",
    "chunk_method": "naive",
    "parser_flag": 1,
    "parser_config": {
        "chunk_token_count": 10,
        "layout_recognize": true,
        "delimiter": "\n"
    }
}
```

#### 响应示例2
```json
{
    "chunks": [
        "Question: 中华人民共和国网络安全法（2016 年11 月7日... \nAnswer: ",
        "第七章附则第一章总则第一条为了保障网络安全...",
        // ... 其他分片内容 ...
    ],
    "sign": true
}
```

### 接口3：直接文本分片

#### 功能描述
直接传入文本内容进行分片处理，无需文件上传步骤

#### 请求说明
- **HTTP方法**: POST
- **URL**: `https://faeb-175-6-30-17.ngrok-free.app/chunk_text`

#### 请求参数
| 字段          | 类型   | 必需 | 说明                                                                 |
|---------------|--------|------|---------------------------------------------------------------------|
| text          | string | ✓    | 需要分片的文本内容                                                  |
| chunk_method  | string | ✓    | 解析方法: naive, manual, qa, table, paper, book, laws, presentation, picture, email |
| parser_flag   | int    | ✓    | 是否需要设置parser_config (0: 否, 1: 是)                           |
| parser_config | dict   |      | 解析器配置                                                          |

#### 请求示例
```json
{
    "text": "这是一个需要分片的长文本内容...",
    "chunk_method": "naive",
    "parser_flag": 1,
    "parser_config": {
        "chunk_token_count": 128,
        "delimiter": "\n"
    }
}
```

#### 响应示例
```json
{
    "chunks": [
        "这是第一个文本分片",
        "这是第二个文本分片",
        "这是第三个文本分片"
    ],
    "sign": true
}
```
