# 知识管理接口

## 训练接口

### 请求示例

```bash
curl -X POST 'http://39.105.167.2:5001/knowledge/update' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "segment_id": "id_xxx",
    "source": "personal",
    "knowledge_type": "faq",
    "question": "社保征缴相关问题指引口径？",
    "similar_questions": ["如何了解社保征缴相关问题？", "社保缴费问题如何咨询？"],
    "answers": [
        {
            "content": "您好，在办理社保缴费登记、申报社保缴费业务时如有疑问，可拨打0769-12366纳税缴费服务热线咨询，其他社会保险问题可直接向"社保姐姐"智能客服提问或拨打东莞市政务服务便民热线0769-12345咨询。感谢您的理解！",
            "channels": ["channel_a", "channel_b"]
        },
        {
            "content": "您好，社保征缴问题可拨打0769-12366咨询，或向智能客服提问。",
            "channels": ["channel_c"]
        }
    ],
    "weight": 5,
    "document_id": "doc_789",
    "keywords": ["社保", "征缴", "咨询"],
    "category_id": "idxxx"
}'
```

- segment_id: 知识点ID
- source: 来源，取值为"personal"（个人知识库）或"system"（系统知识库）
- knowledge_type: 知识类型，取值为"segment"或"faq"，如果类型为segment，则question可以为空，如果类型为faq，则question，answer都必须有值
- question: 问题文本（FAQ类型必填）
- similar_questions: 相似问题列表（可选）
- answers: 答案列表（至少要有一个答案-渠道）
  - content: 答案内容
  - channels: 渠道ID列表
- weight: 权重，数字类型
- document_id: 关联文档ID（非必填），用于关联查看文档
- keywords: 关键字列表（非必填）
- category_id: 知识类别id

### 返回示例

```json
{
  "code": 200,
  "msg": "success"
}
```

## 删除知识

### 请求示例

```bash
curl -X POST 'http://39.105.167.2:5001/knowledge/delete' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "segment_ids": ["知识点ID1", "知识点id2"],
}'
```

- segment_ids: 要删除的知识点ID列表

### 返回示例

```json
{
  "code": 200,
  "msg": "success"
}
```

## 批量绑定关联知识点

### 请求示例

```bash
curl -X POST 'http://39.105.167.2:5001/knowledge/bind_batch' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "library_id": "lib_123456",
    "category_ids": ["知识点ID1", "知识点ID2", "知识点ID3"]
}'
```

- library_id: 库ID，业务库或个人知识库ID
- category_ids: 绑定类别id

### 返回示例

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "success_count": 3,
    "failed_ids": []
  }
}
```

## 批量解绑知识

### 请求示例

```bash
curl -X POST 'http://39.105.167.2:5001/knowledge/unbind_batch' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "library_id": "lib_123456",
    "category_ids": ["知识点ID1", "知识点ID2", "知识点ID3"],
    "delete_type": "part"
}'
```

- library_id: 库ID，业务库或个人知识库ID
- category_ids: 要解绑的知识点ID数组
- delete_type: all为解除库id与所有知识点的绑定，part只解绑segments_ids指定的知识点。

### 返回示例

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "success_count": 3,
    "failed_ids": []
  }
}
```

## 知识搜索接口

### 请求示例

```bash
curl -X POST 'http://39.105.167.2:5001/knowledge/search' \
    --header 'Content-Type: application/json' \
    --data-raw '{
    "query": "社保问题",
    "library_id": "lib_123456",
    "limit": 10
}'
```

- query: 搜索关键词
- library_id: 要搜索的知识库ID（业务库或个人知识库ID）
- limit: 返回结果数量限制（可选，默认10）

### 返回示例

```json
{
  "code": 200,
  "msg": "success",
  "data": [
    {
      "segment_id": "id_xxx",
      "source": "personal",
      "knowledge_type": "faq",
      "question": "社保征缴相关问题指引口径？",
      "similar_questions": ["如何了解社保征缴相关问题？", "社保缴费问题如何咨询？"],
      "answers": [
        {
          "content": "您好，在办理社保缴费登记、申报社保缴费业务时如有疑问，可拨打0769-12366纳税缴费服务热线咨询...",
          "channels": ["channel_a", "channel_b"]
        }
      ],
      "weight": 5,
      "document_id": "doc_789",
      "keywords": ["社保", "征缴", "咨询"],
      "category_id": "idxxx"
    },
    // ...其他搜索结果...
  ]
}
```
